<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Telegram Mini App</title>
  <style>
      @font-face {
      font-family: 'MrCoasterGBlack';
      src: url('20694.otf') format('opentype');
    }

    body {
      margin: 0;
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      font-family: Arial, sans-serif;
      overflow: hidden;
      font-family: 'MrCoasterGBlack', Arial, sans-serif;
    }

    /* –≠–∫—Ä–∞–Ω –∑–∞–≥—Ä—É–∑–∫–∏ */
    .loading-screen {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(-45deg, rgb(34, 2, 24), rgb(94, 58, 8));
      color: #fff; /* –ë–µ–ª—ã–π —Ç–µ–∫—Å—Ç */
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 11; /* –ù–∞ –ø–µ—Ä–µ–¥–Ω–µ–º –ø–ª–∞–Ω–µ */
    }

    .loading-screen.hidden {
      display: none; /* –£–±–∏—Ä–∞–µ–º —ç–∫—Ä–∞–Ω –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ */
    }

    .username {
      font-size: 20px;
      font-weight: bold;
      z-index: 11; /* –ù–∞ –ø–µ—Ä–µ–¥–Ω–µ–º –ø–ª–∞–Ω–µ */
      font-family: 'MrCoasterGBlack', Arial, sans-serif;
    }

    .progress-bar-container {
      position: absolute;
      bottom: 20px;
      width: 80%;
      height: 10px;
      background-color: #000000; /* –¢–µ–º–Ω—ã–π —Ñ–æ–Ω –ø–æ–ª–æ—Å–∫–∏ */
      border-radius: 5px;
      overflow: hidden;
      z-index: 11;
    }

    .progress-bar {
      width: 0;
      height: 100%;
      background-color: rgb(255, 255, 255); /* –ó–µ–ª–µ–Ω—ã–π —Ü–≤–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ */
      transition: width 5s linear; /* –ü–ª–∞–≤–Ω–æ–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞ 5 —Å–µ–∫—É–Ω–¥ */
      z-index: 12;
    }

    /* –û—Å–Ω–æ–≤–Ω–æ–π —ç–∫—Ä–∞–Ω –∏–≥—Ä—ã */
    .game-screen {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(to bottom, rgb(0, 0, 0), rgb(41, 26, 18));
      color: #fff;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 1; /* –ü–æ–∑–∞–¥–∏ —ç–∫—Ä–∞–Ω–∞ –∑–∞–≥—Ä—É–∑–∫–∏ */
      font-family: 'MrCoasterGBlack', Arial, sans-serif;
    }

    .game-screen.hidden {
      display: none; /* –£–±–∏—Ä–∞–µ–º –∏–≥—Ä—É –¥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ */
    }

    .game-content {
      font-size: 24px;
      text-align: center;
    }

    /* –ö–æ–∫–æ—Å –Ω–∞ —ç–∫—Ä–∞–Ω–µ –∑–∞–≥—Ä—É–∑–∫–∏ */
    .loading-coconut {
      position: absolute;
      bottom: 0;
      right: 0;
      transform: translate(50%, 0%); /* –¶–µ–Ω—Ç—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —É–≥–ª—É */
      width: 500px; /* –†–∞–∑–º–µ—Ä –∫–æ–∫–æ—Å–∞ */
      height: auto;
      opacity: 0.5; /* –ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å */
      z-index: 10;

    }
    .container228 {
  position: fixed; /* –§–∏–∫—Å–∏—Ä—É–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –æ–∫–Ω–∞ */
  bottom: 0; /* –ü—Ä–∏–≤—è–∑—ã–≤–∞–µ–º –∫ –Ω–∏–∂–Ω–µ–π —á–∞—Å—Ç–∏ —ç–∫—Ä–∞–Ω–∞ */
  left: 0; /* –ü—Ä–∏–≤—è–∑—ã–≤–∞–µ–º –∫ –ª–µ–≤–æ–º—É –∫—Ä–∞—é */
  width: 100%; /* –†–∞—Å—Ç—è–≥–∏–≤–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–∞ –≤—Å—é —à–∏—Ä–∏–Ω—É —ç–∫—Ä–∞–Ω–∞ */
  display: flex;
  justify-content: space-evenly; /* –†–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ */
  align-items: center;
  height: var(--container-height);
  padding: 0; /* –£–±–∏—Ä–∞–µ–º –æ—Ç—Å—Ç—É–ø—ã, —á—Ç–æ–±—ã –±—ã–ª–æ –≤–ø—Ä–∏—Ç—ã–∫ */
  border: 5px solid transparent;
  background: linear-gradient(to bottom, #ffffff, #b4b4b4);
  background-clip: padding-box, border-box;
  border-radius: 0; /* –£–±–∏—Ä–∞–µ–º —Å–∫—Ä—É–≥–ª–µ–Ω–∏—è –¥–ª—è –∫—Ä–∞–µ–≤ */
  margin: 0;
  outline: none; /* –£–±–∏—Ä–∞–µ–º –∫–æ–Ω—Ç—É—Ä –ø—Ä–∏ —Ñ–æ–∫—É—Å–µ */
  -webkit-tap-highlight-color: transparent; /* –£–±–∏—Ä–∞–µ–º —Å–∏–Ω–∏–π —Ñ–æ–Ω –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ */
}




    
    .button228 {
      background-color: transparent;
      border-radius: 5px;
      height: var(--button-height);
      cursor: pointer;
      margin: 0 5px;
      flex-direction: column;
      display: flex;
      align-items: center;
      text-align: center;
      transition: brightness 0.2s;
 
    }
    
    .button228 img {
      width: 50px;
      height: 50px;
      border-radius: 5px;
      transition: transform 0.2s;
      border-radius: 10px;
    }

    .button228:hover img {
      transform: scale(1.1);
    }
    
    .button228-text {
      margin-top: 4px;
      font-size: 15px;
      color: rgb(0, 0, 0);

    }
    
    .mini-buttons {
      display: none;
      flex-direction: row;
      margin-bottom: 1px;
    }
    
    .mini-button {
      background-color: #59a9c2;
      border: none;
      border-radius: 5px;
      padding: 2px 5px;
      margin: 0 2px;
      cursor: pointer;
      color: white;
      transition: filter 0.2s;
      height: auto;
    }


    img {
            width: 250px;
            top: 40%;
            cursor: pointer;
            outline: none;
            pointer-events: auto;
            -webkit-tap-highlight-color: transparent;
            transition: transform 0.1s;
            user-select: none; /* –ó–∞–ø—Ä–µ—Ç –≤—ã–¥–µ–ª–µ–Ω–∏—è */
        }
    
    #coinImage:active {
      transform: scale(0.9);
    }
    
    img active {
      box-shadow: 2px 2px 5px #fc894d;
    }

        #coin {
  position: absolute; /* –§–∏–∫—Å–∏—Ä—É–µ–º —ç–ª–µ–º–µ–Ω—Ç –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –æ–∫–Ω–∞ */
  top: 5%; /* –û—Ç—Å—Ç—É–ø —Å–≤–µ—Ä—Ö—É 5% */
  left: 50%; /* –¶–µ–Ω—Ç—Ä–∏—Ä—É–µ–º –ø–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª–∏ */
  transform: translateX(-50%); /* –°–º–µ—â–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç –≤–ª–µ–≤–æ –Ω–∞ –ø–æ–ª–æ–≤–∏–Ω—É –µ–≥–æ —à–∏—Ä–∏–Ω—ã –¥–ª—è —Ç–æ—á–Ω–æ–≥–æ —Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è */
  font-size: 24px; /* –†–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞ */
  font-weight: bold; /* –ñ–∏—Ä–Ω—ã–π —Ç–µ–∫—Å—Ç */
  color: #ffffff; /* –¶–≤–µ—Ç —Ç–µ–∫—Å—Ç–∞ */
  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2); /* –¢–µ–Ω—å –¥–ª—è –æ–±—ä–µ–º–∞ */
}

  </style>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <script src="https://telegram.org/js/telegram-web-app.js?56"></script>
</head>
<body>
  <!-- –≠–∫—Ä–∞–Ω –∑–∞–≥—Ä—É–∑–∫–∏ -->
  <div class="loading-screen" id="loadingScreen">
    <p class="username" id="username">One minute please...</p>
    <div class="progress-bar-container">
      <div class="progress-bar" id="progressBar"></div>
    </div>
    <img src="image.png" alt="Coconut" class="loading-coconut">
  </div>

  <!-- –û—Å–Ω–æ–≤–Ω–æ–π —ç–∫—Ä–∞–Ω –∏–≥—Ä—ã -->
  <div class="game-screen hidden" id="gameScreen">
    <div class="game-content">
        <div id="coin"> ü••0</div>
        <img id="coinImage" src="image.png" >
        <div class="container228">
            <div class="button228" onclick="toggleMiniButtons(this)">
              <img src="image.png" alt="–ú–µ–Ω—é" draggable="false">
              <div class="button228-text">Menu</div>
            </div>
            <div class="button228" onclick="toggleMiniButtons(this)">
              <img src="magaz.png" alt="–ü–†–û–∫–∞—á–∫–∞" draggable="false">
              <div class="button228-text">Skin Shop</div>
            </div>
            <div class="button228" onclick="toggleMiniButtons(this)">
              <img src="kvest.png" alt="–ó–∞–¥–∞–Ω–∏—è" id="taskButton" draggable="false">
              <div class="button228-text">Quests</div>
            </div>
            <div class="button228" onclick="toggleMiniButtons(this)">
              <img src="inven.png" alt="–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å" draggable="false">
              <div class="button228-text">Skins Inv</div>
            </div>
            <div class="button228" onclick="toggleMiniButtons(this)">
                <img src="other.png" alt="–ó–∞–¥–∞–Ω–∏—è" id="OTHERmenu" draggable="false">
                <div class="button228-text">Other</div>
              </div>
          </div>
    </div>
  </div>

  <script>
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Web App
    const tg = window.Telegram.WebApp;

    // –ü—Ä–∏–º–µ–Ω—è–µ–º —Ä–µ–∂–∏–º –ø–æ–ª–Ω–æ–≥–æ —ç–∫—Ä–∞–Ω–∞ –¥–ª—è –º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
    tg.expand();

    // –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    const user = tg.initDataUnsafe?.user || {};
    const username = user.username || `${user.first_name || ''} ${user.last_name || ''}`.trim();

    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ
    const usernameElement = document.getElementById('username');
    if (username) {
        usernameElement.innerHTML = `
  <div style="text-align: right; font-size: 45px; line-height: 1.2; margin-right: 20px;">
    <span>Hello,</span><br>
    <span style="font-size: 30px;">${username}!</span>
  </div>
`;
    } else {
      usernameElement.textContent = 'Welcome';
    }

    // –ü—Ä–æ–≥—Ä–µ—Å—Å –∑–∞–≥—Ä—É–∑–∫–∏
    const progressBar = document.getElementById('progressBar');
    setTimeout(() => {
      // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —à–∏—Ä–∏–Ω—É –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–∞ –Ω–∞ 100% –¥–ª—è —Å–∏–º—É–ª—è—Ü–∏–∏ –∑–∞–≥—Ä—É–∑–∫–∏
      progressBar.style.width = '100%';
    }, 0);

    // –£–±–∏—Ä–∞–µ–º —ç–∫—Ä–∞–Ω –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–≥—Ä—É —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥
    setTimeout(() => {
      const loadingScreen = document.getElementById('loadingScreen');
      const gameScreen = document.getElementById('gameScreen');

      // –°–∫—Ä—ã–≤–∞–µ–º —ç–∫—Ä–∞–Ω –∑–∞–≥—Ä—É–∑–∫–∏
      loadingScreen.classList.add('hidden');

      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–≥—Ä–æ–≤–æ–π —ç–∫—Ä–∞–Ω
      gameScreen.classList.remove('hidden');
    }, 5000);

      // –ó–∞–ø—Ä–µ—Ç –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
  document.addEventListener('dragstart', (event) => {
    if (event.target.tagName === 'IMG') {
      event.preventDefault();
    }
  });

  let coinCount = 0;
const coinDisplay = document.getElementById('coin');
const coinImage = document.getElementById('coinImage');

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –º–æ–Ω–µ—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
async function updateCoinsOnServer(telegramId, newCoins) {
    const response = await fetch('/coins', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify({
            telegram_id: telegramId,
            coins: newCoins,
        }),
    });
    const data = await response.json();
    if (data.status !== 'success') {
        console.error('Error updating coins:', data.error);
    }
}

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –º–æ–Ω–µ—Ç —Å —Å–µ—Ä–≤–µ—Ä–∞
async function fetchCoinsFromServer(telegramId) {
    const response = await fetch(`/coins?telegram_id=${telegramId}`);
    const data = await response.json();
    if (data.coins !== undefined) {
        coinCount = data.coins;
        coinDisplay.textContent = `ü••${coinCount.toFixed(0)}`;
    } else {
        console.error('Error fetching coins:', data.error);
    }
}

// –°–æ–±—ã—Ç–∏–µ –¥–ª—è –∫–ª–∏–∫–∞ –Ω–∞ –º–æ–Ω–µ—Ç–∫—É
coinImage.addEventListener('click', (e) => {
    coinCount += 1;
    coinDisplay.textContent = `ü••${coinCount.toFixed(0)}`;
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –º–æ–Ω–µ—Ç—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
    if (window.telegramId) {
        updateCoinsOnServer(window.telegramId, coinCount);
    } else {
        console.error('Telegram ID not found.');
    }
});

// –ü–æ–ª—É—á–µ–Ω–∏–µ Telegram ID –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
Telegram.WebApp.ready();
Telegram.WebApp.onEvent('auth', (data) => {
    window.telegramId = data.user.id; // –°–æ—Ö—Ä–∞–Ω—è–µ–º Telegram ID –≤ –≥–ª–æ–±–∞–ª—å–Ω–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π

    // –ó–∞–≥—Ä—É–∂–∞–µ–º –º–æ–Ω–µ—Ç—ã —Å —Å–µ—Ä–≤–µ—Ä–∞
    fetchCoinsFromServer(window.telegramId);
});



    function toggleMiniButtons(button228) {
      // –£–±–∏—Ä–∞–µ–º –º–∏–Ω–∏-–∫–Ω–æ–ø–∫–∏ –æ—Ç –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫
      document.querySelectorAll('.button228.active').forEach(function(b) {
        if (b !== button228) {
          b.classList.remove('active');
          b.querySelector('.mini-buttons').style.display = 'none';
        }
      });
      // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º –º–∏–Ω–∏-–∫–Ω–æ–ø–∫–∏ –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–Ω–æ–ø–∫–∏
      const miniButtons = button228.querySelector('.mini-buttons');
      miniButtons.style.display = miniButtons.style.display === 'none' ? 'flex' : 'none';
      button228.classList.toggle('active');
    }
    document.getElementById('taskButton').addEventListener('click', () => {
      taskContainer.style.display = taskContainer.style.display === 'none' ? 'block' : 'none';
    });















            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Web App
            window.Telegram.WebApp.initData = window.Telegram.WebApp.initData || '';
        window.Telegram.WebApp.colorScheme = window.Telegram.WebApp.colorScheme || 'light';
        window.Telegram.WebApp.setHeaderColor("#2b2b2b");
        window.Telegram.WebApp.setBackgroundColor("#2b2b2b");
        window.Telegram.WebApp.setBottomBarColor("#2b2b2b");


        // –ü—Ä–∏–º–µ–Ω—è–µ–º —Ä–µ–∂–∏–º –ø–æ–ª–Ω–æ–≥–æ —ç–∫—Ä–∞–Ω–∞ –¥–ª—è –º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        window.Telegram.WebApp.expand();
        window.Telegram.WebApp.requestFullscreen();
  </script>
</body>
</html>
